<!--
title: "1.2: Display Three Doors from a Task File"
status: "Approved"
-->

# Story 1.2: Display Three Doors from a Task File

**As a** developer,
**I want** the application to read tasks from a text file and display three of them as "doors",
**so that** I can see the core interface of the application.

## Acceptance Criteria

1.  On startup, the application reads tasks from `~/.threedoors/tasks.txt`.
2.  If `tasks.txt` does not exist, it is created with a default set of 3-5 sample tasks.
3.  A `FileManager` component is created in `internal/tasks/file_manager.go` to handle file reading and creation.
4.  A `Task` model is defined in `internal/tasks/task.go` to represent a task (for now, just text content).
5.  The main application view (`cmd/threedoors/main.go`) is updated to display three randomly selected tasks from the file.
6.  The display clearly labels them as "Door 1", "Door 2", and "Door 3".
7.  The application still quits on 'q' or 'ctrl+c'.

## Dev Notes

This story implements the most fundamental feature of the application: showing the three doors. It builds on the project setup from Story 1.1 and introduces the first domain logic for handling tasks.

### Parent Epic

*   Parent Epic: [Epic 1: Three Doors Technical Demo](docs/prd/epic-details.md#epic-1-three-doors-technical-demo)

### Previous Story Insights

*   Story 1.1 had a QA failure due to an untracked `session_tracker.go` file. **CRITICAL: Do not interact with or modify this file or its related functionality.** This story should only focus on the components required to display tasks.

### Architecture & Project Structure

*   **Workflow**: This story implements the first half of the `Application Startup & Three Doors Display` workflow. It focuses on loading data and rendering the initial view. [Source: `docs/architecture/core-workflows.md`]
*   **Project Layout**:
    *   `internal/tasks/task.go`: To be created for the `Task` model.
    *   `internal/tasks/file_manager.go`: To be created for file I/O logic.
    *   `cmd/threedoors/main.go`: To be modified to orchestrate the new components and update the view.
    *   [Source: `docs/architecture/source-tree.md`]

### Data Models & Persistence

*   **Task Model**: A simple `Task` struct holding the task's text. For now, we will not implement the full `Task` model with status, notes, etc. from the architecture. We will start with `type Task struct { Text string }`. [Source: `docs/architecture/data-models.md`]
*   **Persistence**: The data source is a plain text file at `~/.threedoors/tasks.txt`, with one task per line. The more complex YAML storage is deferred. [Source: `docs/prd/requirements.md#TD2`]
*   **File Handling**: The `FileManager` should handle the case where the directory `~/.threedoors` or the `tasks.txt` file does not exist, creating them with defaults.

### Tech Stack

*   **Language**: Go `1.25.4`
*   **TUI Framework**: `charmbracelet/bubbletea`
*   **TUI Styling**: `charmbracelet/lipgloss`
*   [Source: `docs/architecture/tech-stack.md`]

### Coding Standards

*   **Formatting**: `gofumpt` must be used.
*   **TUI Output**: All rendering must go through the Bubbletea `View()` method. Do not use `fmt.Println`.
*   **Error Handling**: File operations should include error handling (e.g., if a file can't be read or created).
*   [Source: `docs/architecture/coding-standards.md`]

### Testing

*   Unit tests should be created for the `FileManager` to verify file creation and reading logic. Use `t.TempDir()` to avoid interacting with the actual `~/.threedoors` directory.
*   [Source: `docs/architecture/test-strategy-and-standards.md`]

## Tasks / Subtasks

- [ ] **(AC: 4)** Create `internal/tasks/task.go` with a simple `Task` struct: `type Task struct { Text string }`.
- [ ] **(AC: 2, 3)** Create `internal/tasks/file_manager.go`.
    - Implement a `LoadTasks()` function that reads `~/.threedoors/tasks.txt`.
    - If the file doesn't exist, `LoadTasks()` should create it with a default list of tasks (e.g., "Task 1", "Task 2", "Task 3").
    - The function should return a slice of `Task` structs (`[]Task`).
- [ ] **(AC: 3)** Create `internal/tasks/file_manager_test.go` to test the `LoadTasks` function, including the file creation case.
- [ ] **(AC: 5)** Modify `cmd/threedoors/main.go`:
    - In the `main` function, call `file_manager.LoadTasks()` to get the list of tasks.
    - Create a new root model for the Bubbletea program that holds the list of all tasks and the three currently displayed tasks.
    - Implement logic to randomly select 3 tasks to be displayed as doors.
- [ ] **(AC: 6)** Update the `View()` method in `main.go` to render the three selected tasks, each prefixed with "Door 1:", "Door 2:", and "Door 3:". Use `lipgloss` for basic styling if desired.
- [ ] **(AC: 7)** Ensure the 'q' and 'ctrl+c' quit functionality remains intact.
- [ ] **(AC: 1)** Manually run the application to verify that it correctly reads from `~/.threedoors/tasks.txt` on subsequent runs.
